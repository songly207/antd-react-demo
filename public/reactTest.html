<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Hello World</title>
  <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
</head>
<style>
	.FancyBorder-blue{
		border: 1px solid blue;
	}
</style>
<body>
	
<div id="root" style="margin-left: 30%;"></div>


<script type="text/babel">
  'use strick';
  class Toggle extends React.Component {
    constructor(props) {
      super(props);
      this.state = {isToggleOn: true};

      // 这个绑定是必要的，使`this`在回调中起作用
      this.handleClick = this.handleClick.bind(this);
    }

    handleClick() {
      this.setState(prevState => ({
        isToggleOn: !prevState.isToggleOn
      }));
    }

    render() {
      return (
        <button onClick={this.handleClick}>
          {this.state.isToggleOn ? 'ON' : 'OFF'}
        </button>
      );
    }
  }

  class Clock extends React.Component {
    constructor(props) {
      super(props);
      this.state = {date: new Date()};
    }

    componentDidMount() {
      this.timerID = setInterval(
        () => this.tick(),
        1000
      );
    }

    componentWillUnmount() {
      clearInterval(this.timerID);
    }

    tick() {
      this.setState({
        date: new Date()
      });
    }

    render() {
      return (
        <div>
          <h1>Hello, world!</h1>
          <h2>It is {this.state.date.toLocaleTimeString()}.</h2>
        </div>
      );
    }
  }
  class LoggingButton extends React.Component {
    constructor(props){
        super(props);
        this.handleClick3 = this.handleClick3.bind(this);
    }
    // 这个语法确保 `this` 绑定在 handleClick 中。
    // 警告：这是 *实验性的* 语法。必须是箭头函数 用到this关键字
    handleClick1 = () => {
      //箭头函数中 this 指向 LoggingButton
      console.log('this is 1:',this);
    }
    
    //如果你没有使用属性初始化语法，可以在   回调中使用一个 箭头函数 ：这个语法确保 `this` 被绑定在 handleClick 中
    //不推荐使用此方法然而，如果这个回调被作为 prop(属性) 传递给下级组件，
    //这些组件可能需要额外的重复渲染。我们通常建议在构造函数中进行绑定，以避免这类性能问题。
    handleClick = function () {
      console.log('this is:',this)
    }

		//回调时绑定
    handleClick2 = function () {
      console.log('this is2:',this)
    }
		
		//构造时绑定 推荐此法
    handleClick3 = function () {
      console.log('this is3:',this)
    }


    render() {
      return (
        <div>
          <h3> logginBtn 处理事件 绑定方法</h3>
          <button onClick={this.handleClick1}>
            Click me1  *实验性的* 语法 绑定
          </button><br/>
          <button onClick={(e) => this.handleClick(e)}>
            Click me 箭头函数 绑定
          </button><br/>
          <button onClick={this.handleClick2.bind(this)}>
            Click me2 回调时绑定
          </button><br/>
          <button onClick={this.handleClick3}>
            Click me3 bind in constructor
          </button>
        </div>
      );
    }
  }
  function UserGreeting(props) {
    return <h1>Welcome back!</h1>;
  }

  function GuestGreeting(props) {
    return <h1>Please sign up.</h1>;
  }
  function Greeting(props) {
    const isLoggedIn = props.isLoggedIn;
    if (isLoggedIn) {
      return <UserGreeting />;
    }
    return <GuestGreeting />;
  }

  function LoginButton(props) {
    return (
      <button onClick={props.onClick}>
        Login
      </button>
    );
  }

  function LogoutButton(props) {
    return (
      <button onClick={props.onClick}>
        Logout
      </button>
    );
  }
  class LoginControl extends React.Component {
    constructor(props) {
      super(props);
      this.handleLoginClick = this.handleLoginClick.bind(this);
      this.handleLogoutClick = this.handleLogoutClick.bind(this);
      this.state = {isLoggedIn: false};
    }

    handleLoginClick() {
      this.setState({isLoggedIn: true});
    }

    handleLogoutClick() {
      this.setState({isLoggedIn: false});
    }

    render() {
      const isLoggedIn = this.state.isLoggedIn;

      let button = null;
      if (isLoggedIn) {
        button = <LogoutButton onClick={this.handleLogoutClick} />;
      } else {
        button = <LoginButton onClick={this.handleLoginClick} />;
      }

      return (
        <div>
          <Greeting isLoggedIn={isLoggedIn} />
          {button}
          <sub>
            The user is <b>{isLoggedIn ? 'currently' : 'not'}</b> logged in.
          </sub>
        </div>
      );
    }
  }
  function Mailbox(props) {
    const unreadMessages = props.unreadMessages;
    return (
      <div>
        <h3>逻辑 && 操作符的内联 if 用法:</h3>
        {unreadMessages.length > 0 &&
        <h4>
          You have {unreadMessages.length} unread messages.
        </h4>
        }
      </div>
    );
  };
  const messages = ['React', 'Re: React', 'Re:Re: React'];

  class  LoginTip extends React.Component{
    constructor(){
        super();
        this.state = {isLoggedIn:true};
    }
    render() {
      const isLoggedIn = this.state.isLoggedIn;
      return (
        <div>
          The user is <b>{isLoggedIn ? 'currently' : 'not'}</b> logged in.
        </div>
      );
    }
  }
  function WarningBanner(props) {
    if (!props.warn) {
      return null;
    }

    return (
      <span className="warning">
        Warning!
      </span>
    );
  }

  class Page extends React.Component {
    constructor(props) {
      super(props);
      this.state = {showWarning: true}
      this.handleToggleClick = this.handleToggleClick.bind(this);
    }

    handleToggleClick() {
      this.setState(prevState => ({
        showWarning: !prevState.showWarning
      }));
    }

    // style={{display:"inlineBlock"}}
    render() {
      return (
        <div>
          <button onClick={this.handleToggleClick}>
            {this.state.showWarning ? 'Hide' : 'Show'}
          </button>
          <WarningBanner warn={this.state.showWarning}/>
        </div>
      );
    }
  }


  function Blog(props) {
    const sidebar = (
      <ul>
        {props.posts.map((post) =>
          <li key={post.id}>
            {post.title}
          </li>
        )}
      </ul>
    );
    const content = props.posts.map((post) =>
      <div key={post.id}>
        <h3>{post.title}</h3>
        <p>{post.content}</p>
      </div>
    );
    return (
      <div>
        {sidebar}
        <hr />
        {content}
      </div>
    );
  }

  const posts = [
    {id: 1, title: 'Hello World', content: 'Welcome to learning React!'},
    {id: 2, title: 'Installation', content: 'You can install React from npm.'}
  ];
  
  const numbers = [1, 2, 3, 4, 5];
  const listItems = numbers.map((number) =>
    <li key={number.toString()}>{number}</li>
  );

 /* function NumberList(props) {
    const numbers = props.numbers;
    const listItems = numbers.map((number) =>
      <li key={number.toString()}>{number}</li>
    );
    return (
      <ul>{listItems}</ul>
    );
  }*/
  
	function ListItem(props) {
	  return <li>{props.value}</li>;
	}

	function NumberList(props) {
	  const numbers = props.numbers;
	  return (
	    <ul>
	      {numbers.map((number) =>
	        <ListItem key={number.toString()} value={number} />
	      )}
	    </ul>
	  );
	}
	class NameForm extends React.Component {
	  constructor(props) {
	    super(props);
	    this.state = {value: '',
	    value1: 'favorite element',
	    value2:'coconut',
	    value3:['B','C']
    };
	
	    //this.handleChange = this.handleChange.bind(this);
	    this.handleSubmit = this.handleSubmit.bind(this);
	  }
	
		//实验性语法 绑定
	  handleChange= (event)=> {
	    this.setState({value: event.target.value.toUpperCase()});
	  }
		handleChange1(event) {
    	this.setState({value1: event.target.value});
  	}
		handleChange2(event) {
	    this.setState({value2: event.target.value});
	  }
		
		handleChange3(event) {
	    this.setState({value3: event.target.value});
	  }
		
	  handleSubmit(event) {
	    alert('name:' + this.state.value+
	    'name1:'+this.state.value1+
	    'flavor is:' + this.state.value2+this.state.value3);
	    event.preventDefault();
	  }
	  
	  
	  render() {
	    return (
	      <form onSubmit={this.handleSubmit}>
	        <label>
	          Name:
	          <input type="text" value={this.state.value} onChange={this.handleChange} />
	        </label><br/>
	        <label>
	          Name1:
	          <textarea value={this.state.value1} onChange={this.handleChange1.bind(this)} />
	        </label><br/>
	        <select value={this.state.value2} onChange={(e) => this.handleChange2(e)}>
            <option value="grapefruit">Grapefruit</option>
            <option value="lime">Lime</option>
            <option value="coconut">Coconut</option>
            <option value="mango">Mango</option>
          </select><br/>
          <p>11</p>
          <select multiple={true}  value={['B', 'C']} onChange={(e) => this.handleChange3(e)}>
          	<option value="A">A</option>
          	<option value="B">B</option>
          	<option value="C">C</option>
          	<option value="D">D</option>
          </select><br/>
          
	        <input type="submit" value="Submit" />
	      </form>
	    );
	  }
	}
	
	class FileInput extends React.Component {
	  constructor(props) {
	    super(props);
	    this.handleSubmit = this.handleSubmit.bind(
	      this
	    );
	  }
	  handleSubmit(event) {
	    event.preventDefault();
	    alert(
	      `Selected file - ${
	        this.fileInput.files[0].name
	      }`
	    );
	  }
	
	  render() {
	    return (
	      <form
	        onSubmit={this.handleSubmit}>
	        <label>
	          Upload file:
	          <input type="file" ref={(input) => { this.fileInput = input; }} />
	        </label>
	        <br />
	        <button type="submit">
	          Submit
	        </button>
	      </form>
	    );
	  }
	}
	
	class Reservation extends React.Component {
	  constructor(props) {
	    super(props);
	    this.state = {
	      isGoing: true,
	      numberOfGuests: 2
	    };
	
	    this.handleInputChange = this.handleInputChange.bind(this);
	  }
	
	  handleInputChange(event) {
	    const target = event.target;
	    const value = target.type === 'checkbox' ? target.checked : target.value;
	    const name = target.name;
	
	    this.setState({
	      [name]: value
	    });
	  }
	  handleSubmit(e){
	  	alert(this.state.isGoing+' ,'+this.state.numberOfGuests)
	  }
	
	  render() {
	    return (
	      <form onSubmit={this.handleSubmit.bind(this)}>
	        <label>
	          Is going:
	          <input
	            name="isGoing"
	            type="checkbox"
	            checked={this.state.isGoing}
	            onChange={this.handleInputChange} />
	        </label>
	        <br />
	        <label>
	          Number of guests:
	          <input
	            name="numberOfGuests"
	            type="number"
	            value={this.state.numberOfGuests}
	            onChange={this.handleInputChange} />
	        </label>
	        <button>提交</button>
	      </form>
	    );
	  }
	}
	
	//不受控组件
	class NameForm1 extends React.Component {
	  constructor(props) {
	    super(props);
	    this.handleSubmit = this.handleSubmit.bind(this);
	  }
	
	  handleSubmit(event) {
	    alert('A name was submitted: ' + this.input.value);
	    event.preventDefault();
	  }
	
	  render() {
	    return (
	      <form onSubmit={this.handleSubmit}>
	        <label>
	          Name:
	          <input type="text" ref={(input) => this.input = input} />
	        </label>
	        <input type="submit" value="Submit" />
	      </form>
	    );
	  }
	}
	
	
	function BoilingVerdict(props) {
	  if (props.celsius >= 100) {
	    return <p>The water would boil.</p>;
	  }
	  return <p>The water would not boil.</p>;
	}
	
	class Calculator extends React.Component {
	  constructor(props) {
	    super(props);
	    this.handleChange = this.handleChange.bind(this);
	    this.state = {temperature: ''};
	  }
	
	  handleChange(e) {
	    this.setState({temperature: e.target.value});
	  }
	
	  render() {
	    const temperature = this.state.temperature;
	    return (
	      <fieldset>
	        <legend>Enter temperature in Celsius:</legend>
	        <input
	          value={temperature}
	          onChange={this.handleChange} />
	
	        <BoilingVerdict
	          celsius={parseFloat(temperature)} />
	
	      </fieldset>
	    );
	  }
	}
	/*状态提升*/
	const scaleNames = {
	  c: 'Celsius',
	  f: 'Fahrenheit'
	};
	
	class TemperatureInput extends React.Component {
	  constructor(props) {
	    super(props);
	    this.handleChange = this.handleChange.bind(this);
	    //this.state = {temperature: ''};
	  }
	
	  handleChange(e) {
	    this.props.onTemperatureChange(e.target.value);
	  }
	
	  render() {
	    const temperature = this.props.temperature;
	    const scale = this.props.scale;
	    return (
	      <fieldset>
	        <legend>Enter temperature in {scaleNames[scale]}:</legend>
	        <input value={temperature}
	               onChange={this.handleChange} />
	      </fieldset>
	    );
	  }
	}
	
	class Calculator1 extends React.Component {
		constructor(props) {
	    super(props);
	    this.handleCelsiusChange = this.handleCelsiusChange.bind(this);
	    this.handleFahrenheitChange = this.handleFahrenheitChange.bind(this);
	    this.state = {temperature: '', scale: 'c'};
	  }
		
		handleCelsiusChange(temperature) {
	    this.setState({scale: 'c', temperature});
	  }
		
		handleFahrenheitChange(temperature) {
	    this.setState({scale: 'f', temperature});
	  }
		
		
	  render() {
	  	
	  	const scale = this.state.scale;
	    const temperature = this.state.temperature;
	    const celsius = scale === 'f' ? tryConvert(temperature, toCelsius) : temperature;
	    const fahrenheit = scale === 'c' ? tryConvert(temperature, toFahrenheit) : temperature;
	    
	    return (
	      <div>
	      
	        <TemperatureInput scale="c" 
	        	temperature={celsius}
	        	onTemperatureChange={this.handleCelsiusChange}/>
        	
        	<TemperatureInput  scale="f" 
        		temperature={fahrenheit}
        		onTemperatureChange={this.handleFahrenheitChange} />
        	
        	<BoilingVerdict  celsius={parseFloat(celsius)} />
        	
	      </div>
	    );
	  }
	}
	
	function toCelsius(fahrenheit) {
	  return (fahrenheit - 32) * 5 / 9;
	}
	
	function toFahrenheit(celsius) {
	  return (celsius * 9 / 5) + 32;
	}
	
	function tryConvert(temperature, convert) {
	  const input = parseFloat(temperature);
	  if (Number.isNaN(input)) {
	    return '';
	  }
	  const output = convert(input);
	  const rounded = Math.round(output * 1000) / 1000;
	  return rounded.toString();
	}
	//使用特别的 children prop 来直接传递 子元素到他们的输出中   实现组件 包含 jsx元素 
	function FancyBorder(props) {
	  return (
	    <div className={'FancyBorder FancyBorder-' + props.color}>
	      {props.children}
	    </div>
	  );
	}
	function WelcomeDialog() {
	  return (
	    <FancyBorder color="blue">
	      <h1 className="Dialog-title">
	        Welcome
	      </h1>
	      <p className="Dialog-message">
	        Thank you for visiting our spacecraft!
	      </p>
	    </FancyBorder>
	  );
	}
	
	function SplitPane(props) {
  return (
    <div className="SplitPane">
      <div className="SplitPane-left">
        {props.left}
      </div>
      <div className="SplitPane-right">
        {props.right}
      </div>
    </div>
  );
}
	function App1() {
	  return (
	    <SplitPane
	      left={
	        <Clock />
	      }
	      right={
	        <Blog  posts={posts} />
	      } />
	  );
	}
	//特例 在React中，也可以使用组合来实现，一个偏“特殊”的组件渲染出一个偏“通用”的组件，通过 props(属性) 配置它：
	function Dialog(props) {
	  return (
	    <FancyBorder color="blue">
	      <h1 className="Dialog-title">
	        {props.title}
	      </h1>
	      <p className="Dialog-message">
	        {props.message}
	      </p>
	    </FancyBorder>
	  );
	}
	//我们可能说一个 WelcomeDialog1 是 Dialog 的一个特殊用例。
	function WelcomeDialog1() {
	  return (
	    <Dialog
	      title="Welcome"
	      message="Thank you for visiting our spacecraft!" />
	
	  );
	}
	
	function Dialog1(props) {
	  return (
	    <FancyBorder color="blue">
	      <h1 className="Dialog-title">
	        {props.title}
	      </h1>
	      <p className="Dialog-message">
	        {props.message}
	      </p>
	      {props.children}
	    </FancyBorder>
	  );
	}
	
	class SignUpDialog extends React.Component {
	  constructor(props) {
	    super(props);
	    this.handleChange = this.handleChange.bind(this);
	    this.handleSignUp = this.handleSignUp.bind(this);
	    this.state = {login: ''};
	  }
	
	  render() {
	    return (
	      <Dialog1 title="Mars Exploration Program"
	              message="How should we refer to you?">
	        <input value={this.state.login}
	               onChange={this.handleChange} />
	
	        <button onClick={this.handleSignUp}>
	          Sign Me Up!
	        </button>
	      </Dialog1>
	    );
	  }
	  
	  handleChange(e) {
	    this.setState({login: e.target.value});
	  }
	
	  handleSignUp() {
	    alert(`Welcome aboard, ${this.state.login}!`);
	  }
	}
	
  function App() {
    return (
      <div style={{marginTop:'105px',marginBottom:'125px'}}>
        <Clock />
        <Toggle/><br/>
        <LoggingButton />
        <LoginControl/><br/>
        <Mailbox  unreadMessages={messages}/>
        <LoginTip/>
        <Page/>
        <ul>
          {listItems}
        </ul>
        <NumberList  numbers={[1,2,3,4,5,6,8]}/>
        <Blog  posts={posts} />
        <h3>表单forms 受控组件(Controlled Components)</h3>
        <NameForm/> <br/>
        <FileInput/> <br/>
        <Reservation /><br/>
        <h3>不受控组件 ref 接收dom的值</h3>
        <NameForm1 />
        <h3>状态提升(Lifting State Up)</h3>
        <Calculator />
        <Calculator1 />
        <h3>包含 children 传递prop 子元素</h3>
        <WelcomeDialog />
        <App1/>
        <WelcomeDialog1/>
        <SignUpDialog/>
      </div>
    );
  }

  ReactDOM.render(
    <App/>,
    document.getElementById('root')
  );
</script>
<!--
  Note: this page is a great way to try React but it's not suitable for production.
  It slowly compiles JSX with Babel in the browser and uses a large development build of React.

  To set up a production-ready React build environment, follow these instructions:
  * https://reactjs.org/docs/add-react-to-a-new-app.html
  * https://reactjs.org/docs/add-react-to-an-existing-app.html

  You can also use React without JSX, in which case you can remove Babel:
  * https://reactjs.org/docs/react-without-jsx.html
  * https://reactjs.org/docs/cdn-links.html
-->
</body>
</html>
